<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stock Recruit Covariates • SRJPEdata</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Stock Recruit Covariates">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SRJPEdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/summary_of_data_for_modeling.html">Summary of Data for Modeling </a>
    </li>
    <li>
      <a href="../articles/yearling_ruleset.html">Yearling Ruleset</a>
    </li>
    <li>
      <a href="../articles/site_overview.html">Site Selection for Stock Recruit Modeling</a>
    </li>
    <li>
      <a href="../articles/trap_effort.html">Hours Fished Analysis</a>
    </li>
    <li>
      <a href="../articles/years_to_include_analysis.html">Monitoring Years to Include</a>
    </li>
    <li>
      <a href="../articles/prep_environmental_covariates.html">Passage to Spawner Model Covariate Prep</a>
    </li>
    <li>
      <a href="../articles/sr_covariates.html">Stock Recruit Model Covariate Prep</a>
    </li>
    <li>
      <a href="../articles/forecast_covariates.html">Forecast and Scenario Model Covariate Prep</a>
    </li>
    <li>
      <a href="../articles/temp_regression.html">Filling Temperature Data Gaps</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SRJPE/SRJPEdata" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="sr_covariates_files/kePrint-0.0.1/kePrint.js"></script><link href="sr_covariates_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stock Recruit Covariates</h1>
            
      

      <div class="hidden name"><code>sr_covariates.Rmd</code></div>

    </div>

    
    
<p>There are multiple covariates used in SR JPE modeling that were
developed through separate but related processes. There are currently
two documents describing covariate selection and processing for
different models: (1) Stock Recruit Covariates (this document) and (2)
Adult Model Covariates.</p>
<p>The goal of this document is to process covariates for use in SR JPE
stock recruitment modeling.</p>
<div class="section level2">
<h2 id="selecting-stock-recruit-environmental-covariates">Selecting Stock Recruit Environmental Covariates<a class="anchor" aria-label="anchor" href="#selecting-stock-recruit-environmental-covariates"></a>
</h2>
<p>FlowWest conducted initial literature review and planning to outline
covariates that are expected to be important based on past research.
This work can be found <a href="https://docs.google.com/spreadsheets/d/1Q4VUBE72KdPq0x65y_vUoDMj5dDHp8XwOyDNIyIJKpE/edit#gid=0" class="external-link">here</a>.
FlowWest reviewed covariates with the SR JPE Modeling Advisory Team to
generate the following environmental covariates table to test within the
SR model.</p>
<p><em>Table 1. Summary of covariates to test in stock recruit modeling
based on preliminary literature review.</em></p>
<table class="table  lightable-classic" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
Variable Name
</th>
<th style="text-align:left;">
Description
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
si_gdd_spawn
</td>
<td style="text-align:left;">
Additive measure of temperatures during the adult upstream migration and
spawning window. This window is defined as August-December. The steps
involved in calculating this value include: obtain daily mean
temperature values for each stream (if data are available at a finer
resolution e.g. 15-min intervals then the daily mean is calculated),
filter the dataset to Aug-Dec, add the daily mean values by stream and
year. Missing values are filled in with either the rolling 3-day mean or
if that is not available the monthly mean.
</td>
</tr>
<tr>
<td style="text-align:left;">
si_above_13_temp_day
</td>
<td style="text-align:left;">
Day of the year when water temperature exceeds 13C representing thermal
stress during spawning and incubation in tributaries. 13C is recognized
as the upper limit of water temperature for spawning and incubation. The
data are not filtered to the spawning time period as this threshold is
typically met before August; though Jan and Feb are filtered out as
adults are not yet in the tributaries. The steps involved in calculating
this value include: obtain daily max temperature values for each stream,
calculate the 7-day rolling mean of max values (any missing values are
filled in the weekly mean of the 7DADM), find the min date when the
7DADM is greater than 13
</td>
</tr>
<tr>
<td style="text-align:left;">
si_above_13_temp_week
</td>
<td style="text-align:left;">
This is the same as si_above_13_temp_day except instead of a day of the
year it is the week of the year.
</td>
</tr>
<tr>
<td style="text-align:left;">
si_weekly_max_temp_max
</td>
<td style="text-align:left;">
Weekly max water temperature for tributaries and the mainstem Sacramento
during the spawning and incubation time period. This window is defined
as August-December. Note that daily max temperatures are not available
for Sacramento so daily mean values are used. The steps involved in
calculating this value include: obtain daily max temperature values for
each stream, filter the dataset to Aug-Dec, calculate the weekly max
value for each year and stream, calculate the max value across all
weeks.
</td>
</tr>
<tr>
<td style="text-align:left;">
si_weekly_max_temp_mean
</td>
<td style="text-align:left;">
This is the same as si_weekly_max_temp_max except when summarizing
across all weeks the mean value is calculated
</td>
</tr>
<tr>
<td style="text-align:left;">
si_weekly_max_temp_median
</td>
<td style="text-align:left;">
This is the same as si_weekly_max_temp_max except when summarizing
across all weeks the median value is calculated
</td>
</tr>
<tr>
<td style="text-align:left;">
si_mean_flow
</td>
<td style="text-align:left;">
Mean flow during the spawning and incubation time window. This window is
defined as August-December. The steps involved in calculating this value
include: obtain daily max flow values for each stream, filter the
dataset to Aug-Dec, find the mean flow by stream and year.
</td>
</tr>
<tr>
<td style="text-align:left;">
si_max_flow
</td>
<td style="text-align:left;">
This is the same as si_mean_flow except the max flow by stream and year
is calculated.
</td>
</tr>
<tr>
<td style="text-align:left;">
si_min_flow
</td>
<td style="text-align:left;">
This is the same as si_mean_flow except the min flow by stream and year
is calculated.
</td>
</tr>
<tr>
<td style="text-align:left;">
si_median_flow
</td>
<td style="text-align:left;">
This is the same as si_mean_flow except the median flow by stream and
year is calculated.
</td>
</tr>
<tr>
<td style="text-align:left;">
rr_mean_flow
</td>
<td style="text-align:left;">
Mean flow during the rearing time period. This window is defined as
November-July. The steps involved in calculating this value include:
obtain daily max flow values, filter the dataset to Nov-July, find the
mean flow by stream and year.
</td>
</tr>
<tr>
<td style="text-align:left;">
rr_max_flow
</td>
<td style="text-align:left;">
This is the same as rr_mean_flow except the max flow by stream and year
is calculated.
</td>
</tr>
<tr>
<td style="text-align:left;">
rr_min_flow
</td>
<td style="text-align:left;">
This is the same as rr_mean_flow except the max flow by stream and year
is calculated.
</td>
</tr>
<tr>
<td style="text-align:left;">
rr_median_flow
</td>
<td style="text-align:left;">
This is the same as rr_mean_flow except the max flow by stream and year
is calculated.
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="preparing-covariates">Preparing Covariates<a class="anchor" aria-label="anchor" href="#preparing-covariates"></a>
</h2>
<p>This document focuses on preparing flow and temperature covariates
for use in stock recruit modeling and exploratory analysis.</p>
<div class="section level3">
<h3 id="temperature">Temperature<a class="anchor" aria-label="anchor" href="#temperature"></a>
</h3>
<p>Temperature has been found to influence spawning and rearing.
Therefore it is expected to affect the translation from stock to
recruit. Temperature can be included in multiple different formats which
target different lifestages including:</p>
<ul>
<li>Number of degree days</li>
<li>Day of year when 7DADM is above 13 C</li>
<li>Maximum weekly stream temperature</li>
<li><em>In development: Emergence date (calculated from temperature and
spawning date)</em></li>
</ul>
<div class="section level4">
<h4 id="number-of-degree-days">Number of degree days<a class="anchor" aria-label="anchor" href="#number-of-degree-days"></a>
</h4>
<p>Degree days is defined here as the sum of the daily mean temperatures
between August and December (spawning time period) by year and
stream.</p>
<p><em>Note that for streams with multiple locations the max daily mean
was selected. Clear Creek 2020 value is low which may be due to a few
missing data points in December. This approach is vulnerable to missing
data.</em></p>
<p><img src="sr_covariates_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" width="768"></p>
<p><em>Figure 1. Annual sum of daily mean temperatures during spawning
and incubation time period (Aug - Dec)</em></p>
<div class="section level5">
<h5 id="sacramento-thermal-stress">Sacramento thermal stress<a class="anchor" aria-label="anchor" href="#sacramento-thermal-stress"></a>
</h5>
<p>In the mainstem stock recruit we use the sum of days greater than 20
degrees to indicate thermal stress which could contribute to mortality
ocurring in the tributaries between adult observation and juveniles at
the rotary screw trap. Note that adult data from tributaries is used as
the stock in the mainstem stock recruit model.</p>
<p><img src="sr_covariates_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" width="768"></p>
</div>
</div>
<div class="section level4">
<h4 id="day-of-year-when-7dadm-drops-abovebelow-13-c">Day of year when 7DADM drops above/below 13 C<a class="anchor" aria-label="anchor" href="#day-of-year-when-7dadm-drops-abovebelow-13-c"></a>
</h4>
<p>This covariate is defined as the day of the year and week when the
7DADM is above 13C</p>
<ul>
<li>Data are not filtered to the spawning time period (Aug-Dec) as this
threshold is typically met before August. Data do not include Jan and
Feb as spring run are not in tributaries yet</li>
<li>Below 13C is not included as this does not make sense in terms of
impact on salmon. Temperatures are rarely below 13C during the spawning
time period and if they are, unlikely to be significantly cold enough to
have an impact</li>
<li>Note, we currently do not have max daily temperatures for the
Sacramento so mainstem is not included. There are a few datapoints based
on the plot below that are worth further investigation.</li>
</ul>
<p><strong>Plot of week where threshold is met (above 13 C) for all
years and streams</strong></p>
<p><img src="sr_covariates_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" width="768"></p>
<p><em>Figure 2. Plot of week where threshold is met (above or below 13)
for all years and streams</em></p>
</div>
<div class="section level4">
<h4 id="max-temperature">Max temperature<a class="anchor" aria-label="anchor" href="#max-temperature"></a>
</h4>
<p>This covariate is defined as the summarized annual weekly max
temperature.</p>
<ul>
<li>Summarizes the weekly maximum temperature for each stream (meaning
it finds the max across all sites/subsites) across years within the
spawning period. Note that the Sacramento River temperature data does
not currently include a daily maximum so the weekly max is the max of
the daily mean.</li>
<li>Summarize the weekly max for each stream and year by finding the
mean, median, and max.</li>
</ul>
<p><img src="sr_covariates_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" width="768"></p>
<p><em>Figure 3. Plot of mean, median, max of the maximum weekly
temperature</em></p>
</div>
<div class="section level4">
<h4 id="emergence-date">Emergence date<a class="anchor" aria-label="anchor" href="#emergence-date"></a>
</h4>
<p><em>In development</em></p>
<p>Emergence data encompasses the effect of temperature and is expected
to affect growth and survival of juveniles. Modeled following <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecs2.4160" class="external-link">Kaylor
et al. 2022</a>. Daily Ei values are summed from the spawn date, and
emergence is assumed to occur on the first day where Ei exceeds 1.</p>
<p>Ei = 1 / exp [loge a - loge(Ti - b)]</p>
<p>logea = 6.872 b = -0.332 Ti = mean daily temperature Ei = daily
contribution to development (ranging from 0 to 1)</p>
<p>Constants derived from <a href="https://afspubs.onlinelibrary.wiley.com/doi/epdf/10.1577/1548-8659%281990%29119%3C0927%3ATESADO%3E2.3.CO%3B2" class="external-link">Beacham
and Murray (1990)</a></p>
</div>
</div>
<div class="section level3">
<h3 id="flow">Flow<a class="anchor" aria-label="anchor" href="#flow"></a>
</h3>
<p>Precipitation and streamflow have been found to influence spawning
and rearing. Therefore it is expected to affect the translation from
stock to recruit. Streamflow can be included in multiple different
formats including:</p>
<ul>
<li>Mean, median, max precipitation (or streamflow)</li>
</ul>
<div class="section level4">
<h4 id="mean-median-max-flow">Mean, median, max flow<a class="anchor" aria-label="anchor" href="#mean-median-max-flow"></a>
</h4>
<p>These covariates summarize daily max flows as annual
mean/median/max/min within the spawning and rearing time period.</p>
<p><img src="sr_covariates_files/figure-html/unnamed-chunk-15-1.png" class="r-plt" width="768"></p>
<p><em>Figure 4. Plot of annual summarized (mean, median, max, min) max
flows during the spawning and incubation time period (Aug -
Dec)</em></p>
<p><img src="sr_covariates_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" width="768"></p>
<p><em>Figure 5. Plot of annual summarized (mean, median, max, min) max
flows during the rearing time period (Tributary: Nov - July, Sacramento:
Jan - July)</em></p>
</div>
</div>
<div class="section level3">
<h3 id="combine-and-save-covariate-data">Combine and Save Covariate Data<a class="anchor" aria-label="anchor" href="#combine-and-save-covariate-data"></a>
</h3>
<p>All covariate datasets are combined into one table and saved as an
export from the SRJPEdata package. This data can be accessed using
<code>SRJPEdata::stock_recruit_covariates</code> and can be joined to
the <code><a href="../reference/site_lookup.html">SRJPEdata::site_lookup</a></code> table in order to fill in
covariates for each site and year.</p>
<p>The first 10 rows of <code>SRJPEdata::stock_recruit_covariates</code>
are shown below.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="5%">
<col width="15%">
<col width="26%">
<col width="16%">
<col width="25%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="right">year</th>
<th align="left">stream</th>
<th align="left">lifestage</th>
<th align="left">covariate_type</th>
<th align="left">covariate_structure</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1998</td>
<td align="left">butte creek</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">gdd_spawn</td>
<td align="right">801.500000</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="left">butte creek</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">above_13_temp_day</td>
<td align="right">274.000000</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="left">butte creek</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">above_13_temp_week</td>
<td align="right">40.000000</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="left">butte creek</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">weekly_max_temp_max</td>
<td align="right">17.000000</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="left">butte creek</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">weekly_max_temp_mean</td>
<td align="right">10.750000</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="left">butte creek</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">weekly_max_temp_median</td>
<td align="right">10.000000</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="left">feather river</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">gdd_spawn</td>
<td align="right">610.685252</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="left">feather river</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">weekly_max_temp_max</td>
<td align="right">10.198657</td>
</tr>
<tr class="odd">
<td align="right">1998</td>
<td align="left">feather river</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">weekly_max_temp_mean</td>
<td align="right">7.564606</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="left">feather river</td>
<td align="left">spawning and incubation</td>
<td align="left">temperature</td>
<td align="left">weekly_max_temp_median</td>
<td align="right">7.434778</td>
</tr>
</tbody>
</table>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ashley Vizek, Erin Cain, Liz Stebbins.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
