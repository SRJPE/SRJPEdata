<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filling in temperature data gaps â€¢ SRJPEdata</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Filling in temperature data gaps">
<meta property="og:description" content="SRJPEdata">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SRJPEdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lifestage_ruleset.html">Lifestage Rulesets</a>
    </li>
    <li>
      <a href="../articles/trap_effort.html">Hours Fished Analysis</a>
    </li>
    <li>
      <a href="../articles/years_to_include_analysis.html">Monitoring Years to Include</a>
    </li>
    <li>
      <a href="../articles/prep_environmental_covariates.html">Passage to Spawner Model Covariate Prep</a>
    </li>
    <li>
      <a href="../articles/sr_covariates.html">Stock Recruit Model Covariate Prep</a>
    </li>
    <li>
      <a href="../articles/temp_regression.html">Filling Temperature Data Gaps</a>
    </li>
    <li>
      <a href="../articles/summary_of_data_for_modeling.html">Summary of Data for Modeling </a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SRJPE/SRJPEdata" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Filling in temperature data gaps</h1>
            
      
      
      <div class="hidden name"><code>temp_regression.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="regression-analysis-for-water-temperature-data">Regression Analysis for Water Temperature Data<a class="anchor" aria-label="anchor" href="#regression-analysis-for-water-temperature-data"></a>
</h2>
<p>The goal of this analysis is to fill in data gaps where temperature
data are missing or the time series is incomplete in order to make the
dataset more useful for SR JPE modeling. Temperature is an important
covariate in understanding juvenile production though the completeness
of these data vary by location.</p>
<p>Currently this analysis relies on a regression model and is performed
for the Feather River and Yuba River. The resulting dataset with
predicted values is saved and integrated in the development of a water
temperature dataset.</p>
<div class="section level3">
<h3 id="data-used-to-build-models-butte-creek">Data used to build models: Butte Creek<a class="anchor" aria-label="anchor" href="#data-used-to-build-models-butte-creek"></a>
</h3>
<p>Butte Creek is used to build the regression models because the time
series is complete and the data are high quality.</p>
<ul>
<li>Date range covered in the Butte Creek temperature data is 1999 -
2024</li>
</ul>
</div>
<div class="section level3">
<h3 id="overall-approach-for-water-temperature-regression">Overall approach for water temperature regression:<a class="anchor" aria-label="anchor" href="#overall-approach-for-water-temperature-regression"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Prepare datasets for regression analysis (dataset with no missing
data is used to train the model and dataset with missing data are
predicted using the model)</p></li>
<li><p>Fit and evaluate linear regression models for mean, min, and max
temperatures</p></li>
<li><p>Make predictions for missing data using the fitted
models</p></li>
<li><p>Combine predictions with actual measurements</p></li>
<li><p>Visualize the predicted and actual temperature over time to asses
model performance trends</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="feather-river">Feather River<a class="anchor" aria-label="anchor" href="#feather-river"></a>
</h3>
<div class="section level4">
<h4 id="data-preparation-and-approach">Data Preparation and Approach<a class="anchor" aria-label="anchor" href="#data-preparation-and-approach"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Pull in gage data from CDEC (GRL will represent the High Flow
Channel (HFC) and FRA will represent the Low Flow Channel (LFC))</li>
</ol>
<ul>
<li>GRL (2003-03-05 to 2007-06-01 H; 2020-01-04 to present): located
after Thermalito Afterbay</li>
<li>FRA (2002-01-01 to present): located between Lake Oroville and
Thermalito Afterbay</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Prepare datasets for regression analysis</li>
</ol>
<ul>
<li>Dataset with no missing data to train and test the model (Butte
Creek and Feather River)</li>
<li>Dataset with missing data to make predictions (Feather River)</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>Use data where there are no missing data from either dataset for
regression modeling</p></li>
<li><p>Use the regression model to make predictions from the testing
dataset and evaluate</p></li>
<li><p>Use the model to make predictions for missing data</p></li>
</ol>
</div>
<div class="section level4">
<h4 id="low-flow-channel-lfc">Low Flow Channel (LFC)<a class="anchor" aria-label="anchor" href="#low-flow-channel-lfc"></a>
</h4>
<div class="section level5">
<h5 id="exploratory-analysis">Exploratory analysis<a class="anchor" aria-label="anchor" href="#exploratory-analysis"></a>
</h5>
<p>Before we developed any models, we explored the relationship between
water temperature at each location. There is a linear correlation
between mean, min, and max water temperature on Butte Creek and Feather
River LFC. For example, the plot below suggests a strong linear
relationship between the mean water temperatures of Butte Creek and
Feather River LFC. The positive slope of the linear trend line implies
that higher water temperatures in Butte Creek are associated with higher
water temperatures in Feather River LFC. These visual representations
support the results of the linear regression analysis, which identified
a statistically significant relationship between the mean, max and min
water temperatures of these two locations.</p>
<p><em>Plot of mean temp for Feather River LFC and Butte Creek</em></p>
<p><img src="temp_regression_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="building-regression-models">Building regression models<a class="anchor" aria-label="anchor" href="#building-regression-models"></a>
</h5>
<p>We built 3 regression models for Feather River LFC - one each for
mean, min, and max water temperature relationships. We evaluated the
models using the Mean Absolute Percentage Error (MAPE). The MAPE for all
three models indicated good predictive accuracy.</p>
<ul>
<li>MAPE for the mean model: 0.08488823, which means the modelâ€™s
predictions are off by about 8.49% on average.</li>
<li>MAPE for the min model: 0.08800298, which means the modelâ€™s
predictions are off by about 8.80% on average.</li>
<li>MAPE for the max model: 0.07784735, which means the modelâ€™s
predictions are off by about 7.78% on average.</li>
</ul>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = temp ~ date + butte_temp, data = train)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -4.8330 -0.8279  0.0298  0.7790  5.8936 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -6.382e+00  1.006e+00  -6.342 2.89e-10 ***</span></span>
<span><span class="co">## date         7.303e-04  5.347e-05  13.659  &lt; 2e-16 ***</span></span>
<span><span class="co">## butte_temp   4.146e-01  5.956e-03  69.612  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 1.366 on 1716 degrees of freedom</span></span>
<span><span class="co">##   (1 observation deleted due to missingness)</span></span>
<span><span class="co">## Multiple R-squared:  0.7532, Adjusted R-squared:  0.7529 </span></span>
<span><span class="co">## F-statistic:  2619 on 2 and 1716 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0.08321054</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = temp ~ date + butte_temp, data = train)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -4.6319 -0.8183  0.0508  0.7853  6.1786 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -4.9908611  0.9756643  -5.115 3.48e-07 ***</span></span>
<span><span class="co">## date         0.0006584  0.0000519  12.686  &lt; 2e-16 ***</span></span>
<span><span class="co">## butte_temp   0.3835887  0.0063642  60.273  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 1.328 on 1716 degrees of freedom</span></span>
<span><span class="co">##   (1 observation deleted due to missingness)</span></span>
<span><span class="co">## Multiple R-squared:  0.6994, Adjusted R-squared:  0.6991 </span></span>
<span><span class="co">## F-statistic:  1996 on 2 and 1716 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0.08248482</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = temp ~ date + butte_temp, data = train)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -5.4548 -0.7838  0.0362  0.8297  6.0398 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -8.081e+00  1.036e+00  -7.802 1.05e-14 ***</span></span>
<span><span class="co">## date         8.127e-04  5.502e-05  14.771  &lt; 2e-16 ***</span></span>
<span><span class="co">## butte_temp   4.419e-01  5.636e-03  78.400  &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 1.424 on 1717 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.7933, Adjusted R-squared:  0.7931 </span></span>
<span><span class="co">## F-statistic:  3296 on 2 and 1717 DF,  p-value: &lt; 2.2e-16</span></span></code></pre>
<pre><code><span><span class="co">## [1] NA</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="predictions">Predictions<a class="anchor" aria-label="anchor" href="#predictions"></a>
</h5>
<ul>
<li>Combine predictions (mean, min, max data frames into one)</li>
<li>Reshape data</li>
</ul>
<p>The plot shows the predicted mean temperature of the Feather River
LFC over time (which is similar for min and max predictions as well).
The line represents the trend of the predicted mean temperatures,
indicating how they change as the date progresses. This visualization
helps to identify any patterns or trends in the mean water temperature
over the observed period.</p>
<p><img src="temp_regression_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="full-dataset">Full dataset<a class="anchor" aria-label="anchor" href="#full-dataset"></a>
</h5>
<ul>
<li>Join with original data (merge combined predictions with the
original dataset that includes gage agency and gage number)</li>
<li>Visualize combined data</li>
</ul>
<p>The plot below shows how the mean, min, and max temperatures for the
Feather River LFC over time. Interpolated values are seamlessly
integrated where observed data is missing, ensuring a continuous
temperature dataset. Each water temperature type (mean, min, max) is
represented with a different color to help in distinguishing the
temperature trends and understanding the temperature fluctuations.</p>
<pre><code><span><span class="co">## Rows: 26,934</span></span>
<span><span class="co">## Columns: 7</span></span>
<span><span class="co">## Groups: stream, date, statistic, gage_agency, gage_number, site_group [26,934]</span></span>
<span><span class="co">## $ date        <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1999-12-31, 1999-12-31, 1999-12-31, 2000-01-01, 2000-01-0â€¦</span></span>
<span><span class="co">## $ stream      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "feather river", "feather river", "feather river", "featheâ€¦</span></span>
<span><span class="co">## $ site_group  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "upper feather lfc", "upper feather lfc", "upper feather lâ€¦</span></span>
<span><span class="co">## $ gage_agency <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "interpolated", "interpolated", "interpolated", "interpolaâ€¦</span></span>
<span><span class="co">## $ gage_number <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "interpolated", "interpolated", "interpolated", "interpolaâ€¦</span></span>
<span><span class="co">## $ statistic   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "mean", "max", "min", "mean", "max", "min", "mean", "max",â€¦</span></span>
<span><span class="co">## $ value       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3.609397, 2.943208, 4.063671, 3.679231, 3.385886, 3.872535â€¦</span></span></code></pre>
<p><img src="temp_regression_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div class="section level4">
<h4 id="hfc">HFC<a class="anchor" aria-label="anchor" href="#hfc"></a>
</h4>
<div class="section level5">
<h5 id="exploratory-analysis-1">Exploratory analysis<a class="anchor" aria-label="anchor" href="#exploratory-analysis-1"></a>
</h5>
<p>There is a linear correlation between mean, min, and max water
temperature on Butte Creek and Feather River HFC. For example, the plot
below suggests a strong linear relationship between the mean water
temperatures of Butte Creek and Feather River HFC. The positive slope of
the linear trend line implies that higher water temperatures in Butte
Creek are associated with higher water temperatures in Feather River
HFC. These visual representations support the results of the linear
regression analysis, which identified a statistically significant
relationship between the mean, max and min water temperatures of these
two locations.</p>
<p><em>Plot of mean temp for Feather River HFC and Butte Creek</em></p>
<p><img src="temp_regression_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="building-regression-models-1">Building regression models<a class="anchor" aria-label="anchor" href="#building-regression-models-1"></a>
</h5>
<p>We built 3 regression models for Feather River HFC - one each for
mean, min, and max water temperature relationships. We evaluated the
models using the Mean Absolute Percentage Error (MAPE). The MAPE for all
three models indicated good predictive accuracy.</p>
<ul>
<li>MAPE for the mean model: 0.1252, which means the modelâ€™s predictions
are off by about 12.52% on average.</li>
<li>MAPE for the min model: 0.0973, which means the modelâ€™s predictions
are off by about 9.73% on average.</li>
<li>MAPE for the max model: 0.1364, which means the modelâ€™s predictions
are off by about 13.64% on average.</li>
</ul>
</div>
<div class="section level5">
<h5 id="predictions-1">Predictions<a class="anchor" aria-label="anchor" href="#predictions-1"></a>
</h5>
<ul>
<li>Combine predictions (mean, min, max data frames into one)</li>
<li>Reshape data</li>
</ul>
<p>The plot shows the predicted mean temperature of the Feather River
HFC over time (which is similar for min and max predictions as well).
The line represents the trend of the predicted mean temperatures,
indicating how they change as the date progresses. This visualization
helps to identify any patterns or trends in the mean water temperature
over the observed period.</p>
<p><img src="temp_regression_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="full-dataset-1">Full dataset<a class="anchor" aria-label="anchor" href="#full-dataset-1"></a>
</h5>
<ul>
<li>Join with original data (merge combined predictions with the
original dataset that includes gage agency and gage number)</li>
<li>Visualize combined data</li>
</ul>
<p>The plot below shows how the mean, min, and max temperatures for the
Feather River HFC over time. Interpolated values are seamlessly
integrated where observed data is missing, ensuring a continuous
temperature dataset. Each water temperature type (mean, min, max) is
represented with a different color to help in distinguishing the
temperature trends and understanding the temperature fluctuations.</p>
<pre><code><span><span class="co">## Rows: 26,970</span></span>
<span><span class="co">## Columns: 7</span></span>
<span><span class="co">## Groups: stream, date, statistic, gage_agency, gage_number, site_group [26,970]</span></span>
<span><span class="co">## $ date        <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1999-12-31, 1999-12-31, 1999-12-31, 2000-01-01, 2000-01-0â€¦</span></span>
<span><span class="co">## $ stream      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "feather river", "feather river", "feather river", "featheâ€¦</span></span>
<span><span class="co">## $ site_group  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "upper feather hfc", "upper feather hfc", "upper feather hâ€¦</span></span>
<span><span class="co">## $ gage_agency <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "interpolated", "interpolated", "interpolated", "interpolaâ€¦</span></span>
<span><span class="co">## $ gage_number <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "interpolated", "interpolated", "interpolated", "interpolaâ€¦</span></span>
<span><span class="co">## $ statistic   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "mean", "max", "min", "mean", "max", "min", "mean", "max",â€¦</span></span>
<span><span class="co">## $ value       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10.265964, 10.623874, 10.622761, 10.375638, 11.258797, 10.â€¦</span></span></code></pre>
<p><img src="temp_regression_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="yuba-river">Yuba River<a class="anchor" aria-label="anchor" href="#yuba-river"></a>
</h3>
<div class="section level4">
<h4 id="data-prepartion-and-approach">Data Prepartion and Approach<a class="anchor" aria-label="anchor" href="#data-prepartion-and-approach"></a>
</h4>
<ol style="list-style-type: decimal">
<li>Pull in gage data from YR7 CDEC gage.</li>
</ol>
<ul>
<li>Note that this gage only contains data from 2020 onwards. Originally
we included temperature data collected during RST data collection for
this analysis; however, due to inconsistencies in using two different
data sources the resulting predicted mean values were lower than the min
values as the RST data only has mean data. We then decided to just rely
on the gage data despite the small time period.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Prepare datasets for regression analysis</li>
</ol>
<ul>
<li>Dataset with no missing data to train (Butte Creek and Yuba
River)</li>
<li>Dataset with missing data to predict (Yuba River)</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>Combine datasets with no missing data, and missing data</p></li>
<li><p>Identify gaps to predict</p></li>
<li><p>Use data where there are no missing data for either dataset for
regression modeling</p></li>
</ol>
<div class="section level5">
<h5 id="exploratory-analysis-2">Exploratory analysis<a class="anchor" aria-label="anchor" href="#exploratory-analysis-2"></a>
</h5>
<p>There is a linear correlation between mean, min, and max water
temperature on Butte Creek and Yuba River. For example, the plot below
suggests a strong linear relationship between the mean water
temperatures of Butte Creek and Yuba River. The positive slope of the
linear trend line implies that higher water temperatures in Butte Creek
are associated with higher water temperatures in Yuba River. These
visual representations support the results of the linear regression
analysis, which identified a statistically significant relationship
between the mean, max and min water temperatures of these two
locations.</p>
<p><em>Plot of mean temp for Yuba River and Butte Creek</em></p>
<p><img src="temp_regression_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="building-regression-models-2">Building regression models<a class="anchor" aria-label="anchor" href="#building-regression-models-2"></a>
</h5>
<p>We built 3 regression models for Yuba River - one each for mean, min,
and max water temperature relationships. We evaluated the models using
the Mean Absolute Percentage Error (MAPE). The MAPE for all three models
indicated good predictive accuracy.</p>
<ul>
<li>MAPE for the mean model: 0.0844, which means the modelâ€™s predictions
are off by about 8.44% on average.</li>
<li>MAPE for the min model: 0.0838, which means the modelâ€™s predictions
are off by about 8.38% on average.</li>
<li>MAPE for the max model: 0.078, which means the modelâ€™s predictions
are off by about 7.80% on average.</li>
</ul>
</div>
<div class="section level5">
<h5 id="predictions-2">Predictions<a class="anchor" aria-label="anchor" href="#predictions-2"></a>
</h5>
<ul>
<li>Combine predictions (mean, min, max data frames into one)</li>
<li>Reshape data</li>
</ul>
<p>The plot shows the predicted mean temperature of the Yuba River over
time (which is similar for min and max predictions as well). The line
represents the trend of the predicted mean temperatures, indicating how
they change as the date progresses. This visualization helps to identify
any patterns or trends in the mean water temperature over the observed
period.</p>
<p><img src="temp_regression_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
</div>
<div class="section level5">
<h5 id="full-dataset-2">Full dataset<a class="anchor" aria-label="anchor" href="#full-dataset-2"></a>
</h5>
<ul>
<li>Join with original data (merge combined predictions with the
original dataset that includes gage agency and gage number)</li>
<li>Visualize combined data</li>
</ul>
<p>The plot below shows how the mean, min, and max temperatures for the
Yuba River over time. Interpolated values are seamlessly integrated
where observed data is missing, ensuring a continuous temperature
dataset. Each water temperature type (mean, min, max) is represented
with a different color to help in distinguishing the temperature trends
and understanding the temperature fluctuations.</p>
<pre><code><span><span class="co">## Rows: 26,934</span></span>
<span><span class="co">## Columns: 6</span></span>
<span><span class="co">## Groups: stream, date, statistic, gage_agency, gage_number [26,934]</span></span>
<span><span class="co">## $ date        <span style="color: #949494; font-style: italic;">&lt;date&gt;</span> 1999-12-31, 1999-12-31, 1999-12-31, 2000-01-01, 2000-01-0â€¦</span></span>
<span><span class="co">## $ stream      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "yuba river", "yuba river", "yuba river", "yuba river", "yâ€¦</span></span>
<span><span class="co">## $ gage_agency <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "interpolated", "interpolated", "interpolated", "interpolaâ€¦</span></span>
<span><span class="co">## $ gage_number <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "interpolated", "interpolated", "interpolated", "interpolaâ€¦</span></span>
<span><span class="co">## $ statistic   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "mean", "max", "min", "mean", "max", "min", "mean", "max",â€¦</span></span>
<span><span class="co">## $ value       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 15.68149, 14.68029, 15.87917, 15.77983, 15.31417, 15.61116â€¦</span></span></code></pre>
<p><img src="temp_regression_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ashley Vizek, Erin Cain, Liz Stebbins.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
