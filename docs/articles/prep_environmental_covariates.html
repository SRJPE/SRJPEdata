<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adult Model Covariates â€¢ SRJPEdata</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Adult Model Covariates">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SRJPEdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/summary_of_data_for_modeling.html">Summary of Data for Modeling </a>
    </li>
    <li>
      <a href="../articles/lifestage_ruleset.html">Lifestage Rulesets</a>
    </li>
    <li>
      <a href="../articles/site_overview.html">Site Selection for Stock Recruit Modeling</a>
    </li>
    <li>
      <a href="../articles/trap_effort.html">Hours Fished Analysis</a>
    </li>
    <li>
      <a href="../articles/years_to_include_analysis.html">Monitoring Years to Include</a>
    </li>
    <li>
      <a href="../articles/prep_environmental_covariates.html">Passage to Spawner Model Covariate Prep</a>
    </li>
    <li>
      <a href="../articles/sr_covariates.html">Stock Recruit Model Covariate Prep</a>
    </li>
    <li>
      <a href="../articles/forecast_covariates.html">Forecast and Scenario Model Covariate Prep</a>
    </li>
    <li>
      <a href="../articles/temp_regression.html">Filling Temperature Data Gaps</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SRJPE/SRJPEdata" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Adult Model Covariates</h1>
            
      

      <div class="hidden name"><code>prep_environmental_covariates.Rmd</code></div>

    </div>

    
    
<p>There are multiple covariates used in SR JPE modeling that were
developed through separate but related processes. There are currently
two documents describing covariate selction and processing for different
models: (1) Stock Recruit Covariates and (2) Adult Model Covariates
(this document).</p>
<p>The Passage to Spawner (P2S) model relates spawner counts (from redd
or holding surveys) to upstream passage counts obtained by video
systems. This model is restricted to streams with reliable redd or
holding surveys and reliable upstream passage counts. It is also
restricted to years where the redd/holding and upstream passage datasets
overlap. This vignette describes the process of pulling and processing
environmental covariates for use in the P2S model.</p>
<div class="section level2">
<h2 id="selecting-adult-environmental-covariates">Selecting Adult Environmental Covariates<a class="anchor" aria-label="anchor" href="#selecting-adult-environmental-covariates"></a>
</h2>
<p>Potential environmental covariates hypothesized to influence prespawn
mortality were proposed in meetings with the SR JPE Modeling Advisory
Team (MAT). Five initial categories were identified:</p>
<ul>
<li>temperature</li>
<li>flow</li>
<li>water year type</li>
<li>passage timing</li>
<li>total passage</li>
</ul>
<p>There are many ways to summarize each of these categories and initial
analyses helped identify collinearity and performance of each potential
method by regressing prespawn mortality (calculated as
<code>upstream_count / spawner_count</code>) against the environmental
variable. When we were using redd counts as <code>spawner_count</code>,
our model assumed a 50/50 sex ratio and modified that equation to be
<code>upstream_count / (spawner_count * 0.5)</code>. Generally, one redd
per female is a reasonable assumption although our model left the
possibility open for more than one redd per female <a href="https://www.researchgate.net/publication/233231658_The_Number_of_Redds_Constructed_per_Female_Spring_Chinook_Salmon_in_the_Wenatchee_River_Basin" class="external-link">(source)</a>.
Note that this covariate analysis and preparation does not include the
Sacramento River mainstem as spring run do not spawn on the mainstem
Sacramento.</p>
</div>
<div class="section level2 tabset">
<h2 class="tabset" id="preparing-covariates">Preparing Covariates<a class="anchor" aria-label="anchor" href="#preparing-covariates"></a>
</h2>
<div class="section level3">
<h3 id="temperature">Temperature<a class="anchor" aria-label="anchor" href="#temperature"></a>
</h3>
<p>Several approaches were considered for summarizing temperature:</p>
<ol style="list-style-type: decimal">
<li>Proportion of days where the temperature surpassed a threshold of 20
degrees Celsius <a href="https://www.noaa.gov/sites/default/files/legacy/document/2020/Oct/07354626766.pdf" class="external-link">(source)</a>
</li>
<li>Growing degree days (GDD) with a base temperature of 0 degrees
Celsius <a href="https://www.researchgate.net/publication/279930331_Fish_growth_and_degree-days_I_Selecting_a_base_temperature_for_a_within-population_study%20and%20input%20from%20MAT%20team" class="external-link">(source)</a><br>
</li>
<li>Degree Day 20 (DD20), where cumulative degree days are calculated
against a threshold of 20 degrees Celsius <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0204274" class="external-link">(source)</a>
</li>
</ol>
<p>Following initial analyses and discussions, we focused on approach 3
because it showed the most consistent relationship with prespawn
mortality across streams and accounts for cumulative stress. We
calculated the metric for migration months (March - May) in the
Sacramento River and holding months (May - August) in each tributary.
The resulting dataset is as follows (note that DD less than 0 are set to
0):</p>
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="left">stream</th>
<th align="right">gdd_trib</th>
<th align="right">gdd_sac</th>
<th align="right">gdd_total</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1999</td>
<td align="left">deer creek</td>
<td align="right">10.595238</td>
<td align="right">0.0000000</td>
<td align="right">10.60</td>
</tr>
<tr class="even">
<td align="right">1999</td>
<td align="left">feather river</td>
<td align="right">1.273471</td>
<td align="right">0.0000000</td>
<td align="right">1.27</td>
</tr>
<tr class="odd">
<td align="right">1999</td>
<td align="left">mill creek</td>
<td align="right">2.688823</td>
<td align="right">0.0000000</td>
<td align="right">2.69</td>
</tr>
<tr class="even">
<td align="right">1999</td>
<td align="left">yuba river</td>
<td align="right">45.493129</td>
<td align="right">0.0000000</td>
<td align="right">45.49</td>
</tr>
<tr class="odd">
<td align="right">2000</td>
<td align="left">deer creek</td>
<td align="right">26.173138</td>
<td align="right">0.2142857</td>
<td align="right">26.39</td>
</tr>
<tr class="even">
<td align="right">2000</td>
<td align="left">feather river</td>
<td align="right">6.537028</td>
<td align="right">0.2142857</td>
<td align="right">6.75</td>
</tr>
<tr class="odd">
<td align="right">2000</td>
<td align="left">mill creek</td>
<td align="right">12.967262</td>
<td align="right">0.2142857</td>
<td align="right">13.18</td>
</tr>
<tr class="even">
<td align="right">2000</td>
<td align="left">yuba river</td>
<td align="right">53.182652</td>
<td align="right">0.2142857</td>
<td align="right">53.40</td>
</tr>
<tr class="odd">
<td align="right">2001</td>
<td align="left">clear creek</td>
<td align="right">2.187934</td>
<td align="right">2.0714286</td>
<td align="right">4.26</td>
</tr>
<tr class="even">
<td align="right">2001</td>
<td align="left">deer creek</td>
<td align="right">37.718340</td>
<td align="right">2.0714286</td>
<td align="right">39.79</td>
</tr>
</tbody>
</table>
<p>The following plot is of the growing degree days above the 20 degree
threshold over time for all tributaries:</p>
<p><img src="prep_environmental_covariates_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="flow">Flow<a class="anchor" aria-label="anchor" href="#flow"></a>
</h3>
<p>Maximum flow more effectively captures the high flow events that
support migration speed and passage to upstream holding areas.
Additionally, upon inspection of the data source across multiple years
average maximum flow over the migratory and holding months (March-May
and May-August, respectively) was more representative of the
fluctuations in flow over the entire year. The resulting dataset is as
follows:</p>
<table class="table">
<thead><tr class="header">
<th align="left">stream</th>
<th align="right">year</th>
<th align="right">mean_flow</th>
<th align="right">max_flow</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">battle creek</td>
<td align="right">1995</td>
<td align="right">1013.6758</td>
<td align="right">2395.5714</td>
</tr>
<tr class="even">
<td align="left">battle creek</td>
<td align="right">1996</td>
<td align="right">624.3736</td>
<td align="right">1205.8571</td>
</tr>
<tr class="odd">
<td align="left">battle creek</td>
<td align="right">1997</td>
<td align="right">389.7031</td>
<td align="right">531.6667</td>
</tr>
<tr class="even">
<td align="left">battle creek</td>
<td align="right">1998</td>
<td align="right">1089.8352</td>
<td align="right">2020.0000</td>
</tr>
<tr class="odd">
<td align="left">battle creek</td>
<td align="right">1999</td>
<td align="right">610.8681</td>
<td align="right">1310.4286</td>
</tr>
<tr class="even">
<td align="left">battle creek</td>
<td align="right">2000</td>
<td align="right">517.2527</td>
<td align="right">1183.8571</td>
</tr>
<tr class="odd">
<td align="left">battle creek</td>
<td align="right">2001</td>
<td align="right">318.2253</td>
<td align="right">567.4286</td>
</tr>
<tr class="even">
<td align="left">battle creek</td>
<td align="right">2002</td>
<td align="right">364.0824</td>
<td align="right">515.2857</td>
</tr>
<tr class="odd">
<td align="left">battle creek</td>
<td align="right">2003</td>
<td align="right">611.2473</td>
<td align="right">1134.2857</td>
</tr>
<tr class="even">
<td align="left">battle creek</td>
<td align="right">2004</td>
<td align="right">474.1429</td>
<td align="right">1093.8571</td>
</tr>
</tbody>
</table>
<p>The following plot is of max flow (cfs) over time for all
tributaries:</p>
<p><img src="prep_environmental_covariates_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="water-year-type">Water Year Type<a class="anchor" aria-label="anchor" href="#water-year-type"></a>
</h3>
<p>To account for the influence of large scale interannual climate
variability, we investigated water year type as a covariate as described
by the <a href="https://cdec.water.ca.gov/reportapp/javareports?name=WSIHIST" class="external-link">California
Department of Water Resources</a> and available in the <a href="https://cloud.r-project.org/web/packages/waterYearType/index.html" class="external-link">waterYearType
package in R</a>.</p>
<p>We used the <code>waterYearType</code> package to pull water year
assignments as a categorical covariate. Some streams had very few data
points (i.e.Â for Mill Creek, only seven years were considered
dependable), so we simplified all potential categories of water year
type into either dry (<code>Dry</code>, <code>Below Normal</code>,
<code>Critical</code>) or wet (<code>Wet</code>,
<code>Above Normal</code>). The table below summarizes the number of dry
and wet years that were included:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Water Year Type</th>
<th align="right">Count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">dry</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="left">wet</td>
<td align="right">54</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="combine-and-save-covariate-data">Combine and Save Covariate Data<a class="anchor" aria-label="anchor" href="#combine-and-save-covariate-data"></a>
</h3>
<p>Both continuous environmental variables (flow and temperature) were
standardized and centered within streams before performing any analyses
so that the scale of the data did not affect results. Water year type
was coded as a binary variable as <code>1</code> for wet (wet, above
normal) and <code>0</code> for dry (below normal, dry, critical). The
resulting dataset is as follows (note that flow data has the longest
time series available):</p>
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="left">stream</th>
<th align="right">wy_type</th>
<th align="right">max_flow_std</th>
<th align="right">gdd_std</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1995</td>
<td align="left">battle creek</td>
<td align="right">1</td>
<td align="right">2.4649268</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1996</td>
<td align="left">battle creek</td>
<td align="right">1</td>
<td align="right">0.2895225</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">1997</td>
<td align="left">battle creek</td>
<td align="right">1</td>
<td align="right">-0.9432415</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1998</td>
<td align="left">battle creek</td>
<td align="right">1</td>
<td align="right">1.7781908</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">1999</td>
<td align="left">battle creek</td>
<td align="right">1</td>
<td align="right">0.4807324</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2000</td>
<td align="left">battle creek</td>
<td align="right">1</td>
<td align="right">0.2492953</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2001</td>
<td align="left">battle creek</td>
<td align="right">0</td>
<td align="right">-0.8778505</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2002</td>
<td align="left">battle creek</td>
<td align="right">0</td>
<td align="right">-0.9731942</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">2003</td>
<td align="left">battle creek</td>
<td align="right">1</td>
<td align="right">0.1586534</td>
<td align="right">-0.6228421</td>
</tr>
<tr class="even">
<td align="right">2004</td>
<td align="left">battle creek</td>
<td align="right">0</td>
<td align="right">0.0847294</td>
<td align="right">-0.6228421</td>
</tr>
</tbody>
</table>
<p>The following plot is of standardized covariates (covariates are
colored by type) over time for all tributaries:</p>
<p><img src="prep_environmental_covariates_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<div class="section level4">
<h4 id="save-data-object">Save data object<a class="anchor" aria-label="anchor" href="#save-data-object"></a>
</h4>
<p>Data object saved in <code>SRJPEdata</code> as
<code>p2s_model_covariates_standard.rds</code>. To access documentation
search <code>?SRJPEdata::p2s_model_covariates_standard.rds</code>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ashley Vizek, Erin Cain, Liz Stebbins.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
