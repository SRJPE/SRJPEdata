<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>NA • SRJPEdata</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css"><script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet"><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet"><meta property="og:title" content="NA"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-title-body">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">SRJPEdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="articles/summary_of_data_for_modeling.html">Summary of Data for Modeling </a>
    </li>
    <li>
      <a href="articles/lifestage_ruleset.html">Lifestage Rulesets</a>
    </li>
    <li>
      <a href="articles/site_overview.html">Site Selection for Stock Recruit Modeling</a>
    </li>
    <li>
      <a href="articles/trap_effort.html">Hours Fished Analysis</a>
    </li>
    <li>
      <a href="articles/years_to_include_analysis.html">Monitoring Years to Include</a>
    </li>
    <li>
      <a href="articles/prep_environmental_covariates.html">Passage to Spawner Model Covariate Prep</a>
    </li>
    <li>
      <a href="articles/sr_covariates.html">Stock Recruit Model Covariate Prep</a>
    </li>
    <li>
      <a href="articles/forecast_covariates.html">Forecast and Scenario Model Covariate Prep</a>
    </li>
    <li>
      <a href="articles/temp_regression.html">Filling Temperature Data Gaps</a>
    </li>
  </ul></li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/SRJPE/SRJPEdata" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>NA</h1>
    </div>


<p>This vignette focuses on developing covariates that could be used in forecast or scenario SR JPE models. We build upon prior work that identified and tested covariates using historical data, and transition to how those covariates are adapted for use in forecast or scenario scenarios.</p>
<div class="section level2">
<h2 id="process-for-developing-forecast-covariates">Process for developing forecast covariates<a class="anchor" aria-label="anchor" href="#process-for-developing-forecast-covariates"></a></h2>
<p>The diagram outlines the process for developing covariates for forecast and scenario models.</p>
<p>Some covariates were selected and evaluated based on literature review and expert input, followed by testing with historical data using leave-one-out (LOO) analysis.</p>
<p>As we transition to forecast and scenario model application, we need to find out if the data for a given covariate will be available at the time of forecasting. If yes, the covariate will be included in the forecast model using the same structure as the historical covariate. If the answer is no, meaning the covariate data will not be available during the forecaste period, then two strategies are considered:</p>
<ol style="list-style-type: decimal"><li><p>Use continuous forecast data, if available</p></li>
<li><p>Create a discrete covariate based on historical data: restructure and bin the variable into categories based on historical conditions (e.g. high, medium, low)</p></li>
</ol><div class="float">
<img src="images/sr_jpe_covariate_process_diagram.png" style="width:108.0%" alt="Spring Run JPE Forecast Covariate Process Diagram"><div class="figcaption"><em>Spring Run JPE Forecast Covariate Process Diagram</em></div>
</div>
</div>
<div class="section level2">
<h2 id="covariates-included-in-forecast-models">Covariates included in forecast models<a class="anchor" aria-label="anchor" href="#covariates-included-in-forecast-models"></a></h2>
<table class="table"><caption>Covariate Descriptions</caption>
<colgroup><col width="7%"><col width="92%"></colgroup><thead><tr class="header"><th align="left">name</th>
<th align="left">description</th>
</tr></thead><tbody><tr class="odd"><td align="left">spawning/incubation minimum flow</td>
<td align="left">Use daily max flows for the spawning/incubation time period (Aug-Dec) and then calculate the minimum. This variable is available for all 4 time periods and would be the same because we are using data from the previous Aug-Dec.</td>
</tr><tr class="even"><td align="left">spawning/incubation maximum flow</td>
<td align="left">Use daily max flows for the spawning/incubation time period (Aug-Dec) and then calculate the maximum. This variable is available for all 4 time periods and would be the same because we are using data from the previous Aug-Dec.</td>
</tr><tr class="odd"><td align="left">spawning/incubation maximum temperature</td>
<td align="left">Summarizes the weekly maximum temperature for each stream (meaning it finds the max across all sites/subsites) within the spawning period. Note that the Sacramento River temperature data does not currently include a daily maximum so the weekly max is the max of the mean. An annual value is calculated by taking the max of the weekly max. This variable is available for all 4 time periods and would be the same because we are using data from the previous Aug-Dec.</td>
</tr><tr class="even"><td align="left">above 13C threshold</td>
<td align="left">This covariate is defined as the week of the year when the 7DADM is above 13C. Data are filtered to Mar-Dec because this is the time period where spring run are in the tributaries and may be experiencing temperature stress. Note, we currently do not have max daily temperatures for the Sacramento so mainstem is not included. This variable is available for all 4 time periods and would be the same because we are using data from the previous Aug-Dec.</td>
</tr><tr class="odd"><td align="left">3-category water year type</td>
<td align="left">Use water year type from CDEC for the Sacramento Valley and aggregate into 3 categories: C, D/BN/AN, W. This is a scenario based covariate meaning we do not need any data for the forecast. All 3 categories would be run for the forecast.</td>
</tr><tr class="even"><td align="left">3-category flow exceedance year type</td>
<td align="left">Use the flow exceedance methodology provided by the CDFW Instream Flow team (find mean annual flow by water year for each stream and rank the water years where the top 33% are wet, middle are average, bottom are dry) to categorize years for each stream into 3 categories: wet, average, dry</td>
</tr><tr class="odd"><td align="left">monthly reservoir storage</td>
<td align="left">Using reservoir storage data, calculate the monthly max storage. For each JPE date we would use data from the month prior (e.g for Jan 1 it would be average for Dec)</td>
</tr><tr class="even"><td align="left">monthly peak flow</td>
<td align="left">Calculate the peak flow for each watershed and month. This would be different based on JPE date</td>
</tr></tbody></table><p><em>Note that this covariate list will be iteratively updated and improved</em></p>
</div>
<div class="section level2">
<h2 id="preparing-covariates">Preparing covariates<a class="anchor" aria-label="anchor" href="#preparing-covariates"></a></h2>
<div class="section level3">
<h3 id="continuous-variables">Continuous variables<a class="anchor" aria-label="anchor" href="#continuous-variables"></a></h3>
<div class="section level4">
<h4 id="spawning-and-incubation-flow-variables">Spawning and incubation flow variables<a class="anchor" aria-label="anchor" href="#spawning-and-incubation-flow-variables"></a></h4>
<p>These data are pulled from <code>stock_recruit_covarites</code></p>
<ul><li>
<strong>min flow</strong>: Use daily max flows for the spawning/incubation time period (Aug-Dec) and then calculate the minimum</li>
<li>
<strong>max flow</strong>: Use daily max flows for the spawning/incubation time period (Aug-Dec) and then calculate the maximum</li>
</ul></div>
<div class="section level4">
<h4 id="spawning-and-incubation-temperature-variables">Spawning and incubation temperature variables<a class="anchor" aria-label="anchor" href="#spawning-and-incubation-temperature-variables"></a></h4>
<p>These data are pulled from <code>stock_recruit_covarites</code></p>
<ul><li>
<strong>max temp</strong>: Summarizes the weekly maximum temperature for each stream (meaning it finds the max across all sites/subsites) within the spawning period. Note that the Sacramento River temperature data does not currently include a daily maximum so the weekly max is the max of the mean. An annual value is calculated by taking the max of the weekly max.</li>
<li>
<strong>above 13C threshold</strong>: This covariate is defined as the week of the year when the 7DADM is above 13C. Data are filtered to Mar-Dec because this is the time period where spring run are in the tributaries and may be experiencing temperature stress. This includes holding as well as spawning and incubation time period.</li>
</ul></div>
<div class="section level4">
<h4 id="reservoir-storage">Reservoir storage<a class="anchor" aria-label="anchor" href="#reservoir-storage"></a></h4>
<ul><li>
<strong>monthly reservoir storage</strong>: Using reservoir storage data, calculate the monthly average storage. For each JPE date we would use data from the month prior (e.g for Jan 1 it would be average for Dec). This data contains monthly reservoir storage volumes (acre-feet) for Keswick Reservoir (KES), retrieved from the California Data Exchange Center (CDEC) operated by the California Department of Water Resources (DWR). The earliest data available is in 1965. Stream is NA because it applies to all streams and should not be joined on stream.</li>
</ul><p>Plot the last 10 years - note that data have been filtered to Dec-Mar for use in JPE forecasting</p>
<div class="float">
<img src="figure/unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6"><div class="figcaption">plot of chunk unnamed-chunk-6</div>
</div>
</div>
<div class="section level4">
<h4 id="peak-flow">Peak flow<a class="anchor" aria-label="anchor" href="#peak-flow"></a></h4>
<ul><li>
<strong>monthly peak flow</strong>: Calculate the peak flow for each watershed and month. This would be different based on JPE date. Takes the mean daily flow and finds the max for each month, year, and stream.</li>
</ul><p>Plot the last 10 years</p>
<div class="float">
<img src="figure/unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8"><div class="figcaption">plot of chunk unnamed-chunk-8</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="scenario-variales">Scenario variales<a class="anchor" aria-label="anchor" href="#scenario-variales"></a></h3>
<div class="section level4">
<h4 id="id_3-category-water-year-type">3-category water year type<a class="anchor" aria-label="anchor" href="#id_3-category-water-year-type"></a></h4>
<ul><li>This dataset provides annual Chronological Reconstructed Sacramento and San Joaquin Valley Water Year Hydrologic Classification Indices Based on measured unimpaired runoff (in million acre-feet). It was retrieved from the California Open Data Portal</li>
</ul><div class="float">
<img src="figure/unnamed-chunk-10-1.png" alt="plot of chunk unnamed-chunk-10"><div class="figcaption">plot of chunk unnamed-chunk-10</div>
</div>
</div>
<div class="section level4">
<h4 id="id_3-category-flow-exceedance-year-type">3-category flow exceedance year type<a class="anchor" aria-label="anchor" href="#id_3-category-flow-exceedance-year-type"></a></h4>
<ul><li>
<p>This dataset defines the water year type for each stream based on the methodology outlined in the Standard Operating Procedure for Flow Duration Analysis in California <a href="https://nrm.dfg.ca.gov/FileHandler.ashx?DocumentID=74183" class="external-link">CDFW-IFP-005, August 2013</a>. It uses daily flow data from USGS gages to calculate the mean annual discharge (cfs) for each water year and location. Water years are then ranked by mean discharge within each stream and split into three categories:</p>
<ul><li>Wet: Top 33%</li>
<li>Average: Middle 33%</li>
<li>Dry: Bottom 33%</li>
</ul></li>
</ul><div class="float">
<img src="figure/unnamed-chunk-12-1.png" alt="plot of chunk unnamed-chunk-12"><div class="figcaption">plot of chunk unnamed-chunk-12</div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="combine-and-save-data">Combine and save data<a class="anchor" aria-label="anchor" href="#combine-and-save-data"></a></h2>
<pre><code><span><span class="co">#&gt; Rows: 5,596</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; $ name       &lt;chr&gt; "si_min_flow", "si_min_flow", "si_min_flow", "si_min_flow", "si_min_flow", "si_min_flow", "si_min_flow", "si_min_flow", "si_min_flow", "si_min…</span></span>
<span><span class="co">#&gt; $ year       &lt;dbl&gt; 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1995, 1995, 1995, 1995, 1996, 1996, 1996, 1996, 1996, 1997, 1997, 1997, 1997, 1997…</span></span>
<span><span class="co">#&gt; $ water_year &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ stream     &lt;chr&gt; "deer creek", "deer creek", "deer creek", "deer creek", "deer creek", "deer creek", "deer creek", "deer creek", "deer creek", "battle creek", …</span></span>
<span><span class="co">#&gt; $ value      &lt;dbl&gt; 108, 75, 67, 76, 60, 58, 57, 89, 61, 273, 79, 66, 115, 121, 246, 92, 52, 107, 98, 235, 113, 55, 92, 602, 110, 415, 166, 50, 129, 602, 139, 296…</span></span>
<span><span class="co">#&gt; $ month      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ text_value &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span></code></pre>
<table class="table"><thead><tr class="header"><th align="left">name</th>
<th align="right">year</th>
<th align="right">water_year</th>
<th align="left">stream</th>
<th align="right">value</th>
<th align="right">month</th>
<th align="left">text_value</th>
</tr></thead><tbody><tr class="odd"><td align="left">si_min_flow</td>
<td align="right">1986</td>
<td align="right">NA</td>
<td align="left">deer creek</td>
<td align="right">108</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr><tr class="even"><td align="left">si_min_flow</td>
<td align="right">1987</td>
<td align="right">NA</td>
<td align="left">deer creek</td>
<td align="right">75</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr><tr class="odd"><td align="left">si_min_flow</td>
<td align="right">1988</td>
<td align="right">NA</td>
<td align="left">deer creek</td>
<td align="right">67</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr><tr class="even"><td align="left">si_min_flow</td>
<td align="right">1989</td>
<td align="right">NA</td>
<td align="left">deer creek</td>
<td align="right">76</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr><tr class="odd"><td align="left">si_min_flow</td>
<td align="right">1990</td>
<td align="right">NA</td>
<td align="left">deer creek</td>
<td align="right">60</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr><tr class="even"><td align="left">si_min_flow</td>
<td align="right">1991</td>
<td align="right">NA</td>
<td align="left">deer creek</td>
<td align="right">58</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr><tr class="odd"><td align="left">si_min_flow</td>
<td align="right">1992</td>
<td align="right">NA</td>
<td align="left">deer creek</td>
<td align="right">57</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr><tr class="even"><td align="left">si_min_flow</td>
<td align="right">1993</td>
<td align="right">NA</td>
<td align="left">deer creek</td>
<td align="right">89</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr><tr class="odd"><td align="left">si_min_flow</td>
<td align="right">1994</td>
<td align="right">NA</td>
<td align="left">deer creek</td>
<td align="right">61</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr><tr class="even"><td align="left">si_min_flow</td>
<td align="right">1995</td>
<td align="right">NA</td>
<td align="left">battle creek</td>
<td align="right">273</td>
<td align="right">NA</td>
<td align="left">NA</td>
</tr></tbody></table></div>


  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>

</div>



      <footer><div class="copyright">
  <p></p><p>Developed by Ashley Vizek, Erin Cain, Liz Stebbins.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

